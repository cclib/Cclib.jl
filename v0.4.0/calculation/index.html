<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Additional analyses · Cclib.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://github.com/cclib/Cclib.jl/calculation/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Cclib.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../io/">How to parse files</a></li><li class="is-active"><a class="tocitem" href>Additional analyses</a><ul class="internal"><li><a class="tocitem" href="#C-squared-population-analysis-(CSPA)"><span>C squared population analysis (CSPA)</span></a></li><li><a class="tocitem" href="#Mulliken-population-analysis-(MPA)"><span>Mulliken population analysis (MPA)</span></a></li><li><a class="tocitem" href="#Löwdin-Population-Analysis"><span>Löwdin Population Analysis</span></a></li><li><a class="tocitem" href="#Bickelhaupt-Population-Analysis"><span>Bickelhaupt Population Analysis</span></a></li><li><a class="tocitem" href="#Density-Matrix-calculation"><span>Density Matrix calculation</span></a></li><li><a class="tocitem" href="#Mayer’s-Bond-Orders-(MBO)"><span>Mayer’s Bond Orders (MBO)</span></a></li><li><a class="tocitem" href="#Charge-Decomposition-Analysis"><span>Charge Decomposition Analysis</span></a></li></ul></li><li><a class="tocitem" href="../interop/">Interoperability with other tools</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Additional analyses</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Additional analyses</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cclib/Cclib.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Additional-Analyses"><a class="docs-heading-anchor" href="#Additional-Analyses">Additional Analyses</a><a id="Additional-Analyses-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Analyses" title="Permalink"></a></h1><p>Cclib also allows to further analyse calculation ouputs.</p><h2 id="C-squared-population-analysis-(CSPA)"><a class="docs-heading-anchor" href="#C-squared-population-analysis-(CSPA)">C squared population analysis (CSPA)</a><a id="C-squared-population-analysis-(CSPA)-1"></a><a class="docs-heading-anchor-permalink" href="#C-squared-population-analysis-(CSPA)" title="Permalink"></a></h2><p><strong>CSPA</strong> can be used to determine and interpret the electron density of a molecule. The contribution of the a-th atomic orbital to the i-th molecular orbital can be written in terms of the molecular orbital coefficients:</p><p class="math-container">\[\Phi_{ai} = \frac{c^2_{ai}}{\sum_k c^2_{ki}}\]</p><pre><code class="language-Julia hljs"># Example calculation files can be found in the test folder of the main branch.
julia&gt; using Cclib
julia&gt; aoresults, fragresults, fragcharges = cspa(&quot;./Trp_polar.fchk&quot;)</code></pre><ul><li><span>$aoresults$</span>: a three dimensional array with spin, molecular orbital, and atomic orbitals as the axes, so that <span>$aoresults[1, 46, 1]$</span> gives the contribution of the 1st atomic orbital to the 46th alpha/restricted molecular orbital,</li><li><span>$fragresults$</span>: a three dimensional array with spin, molecular orbital, and atoms as the axes, so that <span>$fragresults[1, 24, 5]$</span> gives the contribution of the 5th fragment orbitals to the 24th beta molecular orbital)</li><li><span>$fragcharges$</span>: a vector with the number of (partial) electrons in each fragment, so that <span>$fragcharges[3]$</span> gives the number of electrons in the 3rd fragment.</li></ul><h2 id="Mulliken-population-analysis-(MPA)"><a class="docs-heading-anchor" href="#Mulliken-population-analysis-(MPA)">Mulliken population analysis (MPA)</a><a id="Mulliken-population-analysis-(MPA)-1"></a><a class="docs-heading-anchor-permalink" href="#Mulliken-population-analysis-(MPA)" title="Permalink"></a></h2><p>MPA can be used to determine and interpret the electron density of a molecule. The contribution of the a-th atomic orbital to the i-th molecular orbital in this method is written in terms of the molecular orbital coefficients, c, and the overlap matrix, S:</p><p class="math-container">\[\Phi_{ai} = \sum_b c_{ai} c_{bi} S_{ab}\]</p><pre><code class="language-Julia hljs">julia&gt; using Cclib
julia&gt; aoresults, fragresults, fragcharges = mpa(&quot;./Trp_polar.fchk&quot;)</code></pre><ul><li><span>$aoresults$</span>: a three dimensional array with spin, molecular orbital, and atomic orbitals as the axes, so that <span>$aoresults[1, 46, 1]$</span> gives the contribution of the 1st atomic orbital to the 46th alpha/restricted molecular orbital,</li><li><span>$fragresults$</span>: a three dimensional array with spin, molecular orbital, and atoms as the axes, so that <span>$fragresults[1, 24, 5]$</span> gives the contribution of the 5th fragment orbitals to the 24th beta molecular orbital)</li><li><span>$fragcharges$</span>: a vector with the number of (partial) electrons in each fragment, so that <span>$fragcharges[3]$</span> gives the number of electrons in the 3rd fragment.</li></ul><h2 id="Löwdin-Population-Analysis"><a class="docs-heading-anchor" href="#Löwdin-Population-Analysis">Löwdin Population Analysis</a><a id="Löwdin-Population-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Löwdin-Population-Analysis" title="Permalink"></a></h2><pre><code class="language-Julia hljs">julia&gt; using Cclib
julia&gt; aoresults, fragresults, fragcharges = lpa(&quot;./Trp_polar.fchk&quot;)</code></pre><ul><li><span>$aoresults$</span>: a three dimensional array with spin, molecular orbital, and atomic orbitals as the axes, so that <span>$aoresults[1, 46, 1]$</span> gives the contribution of the 1st atomic orbital to the 46th alpha/restricted molecular orbital,</li><li><span>$fragresults$</span>: a three dimensional array with spin, molecular orbital, and atoms as the axes, so that <span>$fragresults[1, 24, 5]$</span> gives the contribution of the 5th fragment orbitals to the 24th beta molecular orbital)</li><li><span>$fragcharges$</span>: a vector with the number of (partial) electrons in each fragment, so that <span>$fragcharges[3]$</span> gives the number of electrons in the 3rd fragment.</li></ul><h2 id="Bickelhaupt-Population-Analysis"><a class="docs-heading-anchor" href="#Bickelhaupt-Population-Analysis">Bickelhaupt Population Analysis</a><a id="Bickelhaupt-Population-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Bickelhaupt-Population-Analysis" title="Permalink"></a></h2><p>The Bickelhaupt class available from cclib.method performs Bickelhaupt population analysis that has been proposed in <em>Organometallics</em> 1996, 15, 13, 2923–2931. <a href="https://pubs.acs.org/doi/abs/10.1021/om950966x">doi:10.1021/om950966x</a></p><p>The contribution of the a-th atomic orbital to the i-th molecular orbital in this method is written in terms of the molecular orbital coefficients, c, and the overlap matrix, S:</p><p class="math-container">\[\Phi_{ai,\alpha} = \sum_b w_{ab,\alpha} c_{ai,\alpha} c_{bi,\alpha} S_{ab}\]</p><p>where the weights <span>$w_{ab}$</span> that are applied on the Mulliken atomic orbital contributions are defined as following when the coefficients of the molecular orbitals are substituted into equation 11 in the original article.</p><p class="math-container">\[w_{ab,\alpha} = 2 \frac{\sum_k c_{ak,\alpha}^2}{\sum_i c_{ai,\alpha}^2 + \sum_j c_{bj,\alpha}^2}\]</p><p>In case of unrestricted calculations, <span>$\alpha$</span> charges and <span>$\beta$</span> charges are each determined to obtain total charge. In restricted calculations, <span>$\alpha$</span> subscript can be ignored since the coefficients are equivalent for both spin orbitals.</p><p>The weights are introduced to replace the somewhat arbitrary partitioning of off-diagonal charges in the Mulliken population analysis, which divides the off-diagonal charges identically to both atoms. Bickelhaupt population analysis instead divides the off-diagonal elements based on the relative magnitude of diagonal elements.</p><pre><code class="language-Julia hljs">julia&gt; using Cclib
julia&gt; aoresults, fragresults, fragcharges = bpa(&quot;./Trp_polar.fchk&quot;)</code></pre><ul><li><span>$aoresults$</span>: a three dimensional array with spin, molecular orbital, and atomic orbitals as the axes, so that <span>$aoresults[1, 46, 1]$</span> gives the contribution of the 1st atomic orbital to the 46th alpha/restricted molecular orbital,</li><li><span>$fragresults$</span>: a three dimensional array with spin, molecular orbital, and atoms as the axes, so that <span>$fragresults[1, 24, 5]$</span> gives the contribution of the 5th fragment orbitals to the 24th beta molecular orbital)</li><li><span>$fragcharges$</span>: a vector with the number of (partial) electrons in each fragment, so that <span>$fragcharges[3]$</span> gives the number of electrons in the 3rd fragment.</li></ul><h2 id="Density-Matrix-calculation"><a class="docs-heading-anchor" href="#Density-Matrix-calculation">Density Matrix calculation</a><a id="Density-Matrix-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Density-Matrix-calculation" title="Permalink"></a></h2><p>Calculates the electron density matrix</p><pre><code class="language-Julia hljs">julia&gt; using Cclib
julia&gt; result = density(&quot;./Trp_polar.fchk&quot;)</code></pre><p>Returns an array with three axes. The first axis is for the spin contributions, the second and the third axes for the density matrix, which follows standard definition.</p><h2 id="Mayer’s-Bond-Orders-(MBO)"><a class="docs-heading-anchor" href="#Mayer’s-Bond-Orders-(MBO)">Mayer’s Bond Orders (MBO)</a><a id="Mayer’s-Bond-Orders-(MBO)-1"></a><a class="docs-heading-anchor-permalink" href="#Mayer’s-Bond-Orders-(MBO)" title="Permalink"></a></h2><p>Calculates Mayer&#39;s bond orders</p><pre><code class="language-Julia hljs">julia&gt; using Cclib
julia&gt; result = mbo(&quot;./Trp_polar.fchk&quot;)</code></pre><p>Returns an array with three axes. The first axis is for contributions of each spin to the MBO, while the second and the third correspond to the indices of the atoms.</p><h2 id="Charge-Decomposition-Analysis"><a class="docs-heading-anchor" href="#Charge-Decomposition-Analysis">Charge Decomposition Analysis</a><a id="Charge-Decomposition-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Charge-Decomposition-Analysis" title="Permalink"></a></h2><p>The Charge Decomposition Analysis (CDA) as developed by Gernot Frenking et al. is used to study the donor-acceptor interactions of a molecule in terms of two user-specified fragments.</p><pre><code class="language-Julia hljs">julia&gt; using Cclib
julia&gt; donations, bdonations, repulsions = cda(&quot;BH3CO-sp.log&quot;, &quot;BH3.log&quot;, &quot;CO.log&quot;)</code></pre><p>Returns donations, bdonations (back donations), and repulsions attributes. These attributes are simply lists of 1-dimensional arrays corresponding to the restricted or alpha/beta molecular orbitals of the entire molecule.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../io/">« How to parse files</a><a class="docs-footer-nextpage" href="../interop/">Interoperability with other tools »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 21 August 2023 19:48">Monday 21 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
